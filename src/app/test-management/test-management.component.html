<div class="wrapper">


  <div class="col-sm-12 col-md-12 col-lg-9">

    <h4 *ngIf="selectedTestSuite">{{ selectedTestSuite.name }}</h4>
    <clr-datagrid *ngIf="testCases" [(clrDgSelected)]="selectedTestCases" [clDgRowSelection]="true">

      <clr-dg-action-bar>
        <div class="btn-group">
          <button type="button" class="btn btn-sm btn-secondary" (click)="onAdd()" *ngIf="selectedTestSuite != ''">
            <clr-icon shape="plus"></clr-icon> {{ 'TESTMANAGEMENTPAGE.ADD' | translate }}</button>
          <button type="button" class="btn btn-sm btn-secondary" (click)="onDelete()" *ngIf="selectedTestCases.length > 0">
            <clr-icon shape="close"></clr-icon> {{ 'TESTMANAGEMENTPAGE.DELETE' | translate }}</button>
          <button type="button" class="btn btn-sm btn-secondary" (click)="onEdit()" *ngIf="selectedTestCases.length == 1">
            <clr-icon shape="pencil"></clr-icon> {{ 'TESTMANAGEMENTPAGE.EDIT' | translate }}</button>
        </div>
      </clr-dg-action-bar>

      <clr-dg-column>{{ 'TESTMANAGEMENTPAGE.TITLE' | translate }}</clr-dg-column>
      <!--<clr-dg-column>Status</clr-dg-column>-->

      <clr-dg-row *clrDgItems="let testCase of testCases" [clrDgItem]="testCase">
        <!--
        <clr-dg-cell style="display: flex;">
            <clr-checkbox></clr-checkbox>
          <span style="align-self: center;">{{user.name}}</span>
        </clr-dg-cell>
      -->
        <clr-dg-cell>
          {{testCase.title}}
        </clr-dg-cell>

        <!--
          <clr-dg-cell>
            <div class="select">
              <select id="selects_1">
                <option>Untested</option>
                <option>In Progress</option>
                <option>Passed</option>
                <option>Failed</option>
                <option>Skipped</option>
              </select>
            </div>
          </clr-dg-cell>
-->
      </clr-dg-row>

      <clr-dg-footer>{{testCases.length}}</clr-dg-footer>
    </clr-datagrid>



  </div>







  <!-- TEST SUITES TREE COMPONENT -->
  <div *ngIf="testSuitesViewModel.length > 0" class="sidenav" [clr-nav-level]="2">
    <!-- TODO move to testsuites tree component -->

    <clr-tree-node *ngFor="let testSuite of testSuitesViewModel">
      <!--<button (click)="openTestSuite(testSuite)" class="clr-treenode-link">-->
      <clr-icon [attr.shape]="testSuite.icon"></clr-icon>
      {{testSuite.name}}
      <!--</button>-->
      <ng-template [(clrIfExpanded)]="testSuite.expanded">
        <clr-tree-node *ngFor="let subTestSuite of testSuite.children">
          <button clrVerticalNavLink (click)="openTestSuite(subTestSuite)" class="clr-treenode-link" [class.active]="subTestSuite._id === selectedTestSuite">
            <clr-icon [attr.shape]="subTestSuite.icon"></clr-icon>
            {{subTestSuite.name}}
          </button>
        </clr-tree-node>
      </ng-template>
    </clr-tree-node>
  </div>

  <clr-modal *ngIf="testcase" [(clrModalOpen)]="createOpened">
    <h3 class="modal-title">Создать тест кейс</h3>
    <div class="modal-body">
      <form (ngSubmit)="createOpened = false; createTestCase()" id="createTestCaseForm" #createTestCaseForm="ngForm" (keyup.enter)="createTestCaseForm.form.valid && createTestCaseForm.ngSubmit.emit();">
        <section class="form-block">
          <label>Детали</label>

          <div class="form-group">
            <label class="required" for="title">Title</label>
            <input type="text" id="title" name="title" [(ngModel)]="testcase.title" #title="ngModel" required placeholder="Test case example title"
              size="35">
          </div>

          <div class="form-group">
            <label for="description">Description</label>
            <input type="text" id="description" name="description" [(ngModel)]="testcase.description" #description="ngModel"
              placeholder="Test case check login functionality" size="35">
          </div>
        </section>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline" (click)="createOpened = false">{{ 'TESTMANAGEMENTPAGE.CANCEL' | translate }}</button>
      <button type="button" class="btn btn-primary" (click)="createTestCaseForm.ngSubmit.emit();" [disabled]="!createTestCaseForm.form.valid">Create</button>
    </div>
  </clr-modal>


  <clr-modal [(clrModalOpen)]="deleteOpened">
    <h3 class="modal-title">{{ 'TESTMANAGEMENTPAGE.MODAL_DELETE_HEADER' | translate }}</h3>
    <div class="modal-body">
      <p>{{ 'TESTMANAGEMENTPAGE.MODAL_DELETE_DESCRIPTION' | translate }}</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline" (click)="deleteOpened = false">{{ 'TESTMANAGEMENTPAGE.CANCEL' | translate }}</button>
      <button type="button" class="btn btn-primary btn-danger" (click)="deleteOpened = false; forceDelete();">{{ 'TESTMANAGEMENTPAGE.DELETE' | translate }}</button>
    </div>
  </clr-modal>

</div>
